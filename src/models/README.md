# Документация по использования PipeLine
---

## Инициализация

Для того чтоы инициализировать моделей для анализа сигалов ЭКГ и генерации промежуточного диагноза, на вход классу PipeLine при инициализации нужно подать набор конфигурационных парметров конфигурационных словарей (signal_anality, generation_config, gen_details, из которых обязателен только первый). Передачу данных конфигурационных словарей можно выполнить одним из трех методов. 

...[^1] Задать в качестве параметра config путь до папки в которой лежат все конфигурационные словари (либо в .json, либо в .yaml) 
...[^2] Задать в качестве входа путь до одного общего конфигурационного словаря который объядинял бы все остальные
...[^3] Задать в качестве входа список путей до кждого конфигурационного словоря по отдельности
...[^4] Задать в качестве входа общий конфигурационный файл в формате который использовался во втором методе

### Описание конфигурационных словарей:

[^1] Конфигурационный словарь signal_analitic, содержит параметры модели основанной на сверточных слоях, отвечающей за анализ сигналов кфтвщь ЭКГ сигналов и генерацю по ним вектора со значениями RR, PR, QRS, QT. Данный словарь имеет ввид:
```json
{
    "backbone": {
        "projection": {
            "in_channels": [12,32,64],
            "out_channels": [32,64,128],
            "embedding_dim": [32, 32, 64]
        },
        "conv": {
            "kernel_size": [3, 3],
            "padding": 1,
            "stride": 2
        },
        "pool": {
            "kernel_size": [3, 3],
            "padding": 1,
            "stride": 1
        }
    },
    "out_head": {
        "type": "multyoutput",
        "params": {
            "embedding_dim": 16,
            "dims": [
                4
            ]
        }
    }
}
```

#### паарметры
- backbone: Dcit
    - .projection: Dict[List[int]] - задает набор размерностей для проектирования которые сверточным слоем основанным на механизме внимания. Кол-во слоев значений данных полей данного параметра рано кол-ву слоев которые используеются моделью.

        - in_channels: List[int] - список входных размерностей для каждого сверточного слоя 
        - out_channels: List[int] - список выходных размерностей для каждого сверточного слоя
        - embedding_dim: List[int] - размерностей для проецироания сжатных представлений активаций сверточных слоев для применения механизма внимания

    - conv: Dict[List[int]] - задает параметры необходимые для работы сверточныйх слоев которые стоят между сверточными слоями основанными на механизме внимания
        - kernel_size: Tuple[int] - размерность ядра свертки для верточных слоев которые использует модельь
        - padding: int - размерность паддинга сверточного слоя
        - stride: int - шаг свертки

    - pool: Dcit[List[int]] - задает параметры необходимые для работы слоев пулинга для стоящийх между всеми вычислительными блоками
        - kernel_size: Tuple[int] - размерность окна по которому проводится пуллинг
        - padding: int - размерность паддинга слоя пуллинга (смысл тот же что и в сверточных слоях)
        - stride: int - шаг пуллинга
    
- out_head: Dict[List[int]] - конфигурация выходной головы модели по анализу входящих сигналов
    - type: srt - тип выходной головы. На данный момент предусмотренно две вариции, одна для классификции, другая для многомерной линейного регрессии
    - params: Dict - набор параметров для того или иного вида модели 
        - [lin. regression model]:
            - embedding_dim: int - размерность проекции лдя предобраобтки входного вектора полученного backbone
            - dims: List[int] - список размерностей выходных голов.
        - [classification model]: 
            - embedding_dim: int - имеет тот же смысл что и для задачи линейной регрессии
            - hiden_featuers: int - размерность скрытых полносвязных слоев модели классификации
            - n_classes: int - кол-во классов для предсказания 
... .